webpackJsonp([3],{cLg7:function(e,t){},pqZn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("5/aF"),r=n.n(a),o=n("Z34F"),s=n.n(o),i=n("1p1D"),c=n.n(i),l=n("T7Ta"),p=n.n(l),u=n("Quz9"),d=n("DErN"),f={mixins:[u.a],components:{"my-button":d.a},data:function(){return{form:{id:"",role:"",note:"",permission:[]},checkList:[]}},methods:{handleCheckChange:function(){this.form.permission=this.$refs.tree.getCheckedKeys()},clear:function(){this.form={id:"",role:"",note:"",permission:[]}},setDefaultValues:function(){var e=this;return s()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("edit"!==e.type){t.next=15;break}return t.prev=1,t.next=4,e.$http.post("/admin/role/role",{id:e.form.id});case 4:n=t.sent,a=n.data,p()(e.form,a.data),e.$refs.tree.setCheckedKeys(e.form.permission),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.log(t.t0);case 13:t.next=16;break;case 15:p()(e.form,{id:"",role:"",note:"",permission:[]});case 16:case"end":return t.stop()}},t,e,[[1,10]])}))()},getAllPermissions:function(){var e=this;return s()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/admin/permission/checklist",{p:1});case 3:n=t.sent,a=n.data,e.checkList=a.data,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},save:function(){var e=this;return s()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"new"!==e.type){t.next=7;break}return t.next=4,e.$http.post("/admin/role/add",c()({},e.form));case 4:e.success("添加成功"),t.next=10;break;case 7:return t.next=9,e.$http.post("/admin/role/edit",c()({},e.form));case 9:e.success("修改成功");case 10:e.$emit("save-success"),e.close(),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.log(t.t0);case 17:case"end":return t.stop()}},t,e,[[0,14]])}))()}},mounted:function(){this.getAllPermissions()}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"新增角色",visible:e.visible,width:"800px"},on:{"update:visible":function(t){e.visible=t}}},[n("div",{staticClass:"comp-employee-editor"},[n("el-form",{attrs:{"label-width":"80px","label-position":"left"}},[n("el-form-item",{attrs:{label:"角色名"}},[n("el-input",{model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}})],1),n("el-form-item",{attrs:{label:"备注"}},[n("el-input",{model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1),n("el-form-item",{attrs:{label:"权限"}},[n("el-tree",{ref:"tree",attrs:{data:e.checkList,"show-checkbox":"show-checkbox",props:{label:"title"},"node-key":"id"},on:{"check-change":e.handleCheckChange}})],1),n("el-form-item",{attrs:{label:""}},[n("my-button",{attrs:{click:e.save}},[e._v("保存")])],1)],1)],1)])},staticRenderFns:[]};var h=n("7jd7")(f,m,!1,function(e){n("cLg7")},"data-v-7b979dc2",null).exports,v={mixins:[n("0wMN").a],data:function(){return{list:[],loading:!1}},components:{"my-role-editor":h},methods:{addRole:function(){var e=this.$refs["my-role-editor"];e.setEditorType("new"),e.open()},req:function(){var e=this;return s()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/admin/role/list",{p:e.pagination.curPage});case 3:n=t.sent,a=n.data,e.list=a.data.list,e.pagination.pageTotal=a.data.total,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},edit:function(e){var t=this.$refs["my-role-editor"];t.setId(e.id),t.open()},deleteRole:function(e){var t=this;return s()(r.a.mark(function n(){return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$http.post("/admin/role/delete",{id:e.id});case 3:t.success("删除成功"),t.req(),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0);case 10:case"end":return n.stop()}},n,t,[[0,7]])}))()}},mounted:function(){this.req()}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-permission-role"},[n("my-page-title",{attrs:{title:"角色列表"}}),n("my-common-bar",{attrs:{formDisplay:!1,newBtnText:"新增角色"},on:{new:e.addRole}}),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"content"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,border:"border"}},[n("el-table-column",{attrs:{align:"center",type:"index"}}),n("el-table-column",{attrs:{align:"center",label:"角色名",prop:"role"}}),n("el-table-column",{attrs:{align:"center",label:"操作",prop:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){e.edit(t.row)}}},[e._v("编辑")]),n("el-button",{attrs:{type:"text"},on:{click:function(n){e.deleteRole(t.row)}}},[e._v("删除")])]}}])})],1)],1),n("div",{staticClass:"pager"},[n("el-pagination",{attrs:{layout:"total,slot,prev,pager,next","current-page":e.pagination.curPage,"page-size":e.pagination.pageSize,total:e.pagination.pageTotal},on:{"update:currentPage":function(t){e.$set(e.pagination,"curPage",t)},"current-change":e.pageCurPageChange,"size-change":e.pageSizeChange}})],1),n("my-role-editor",{ref:"my-role-editor",on:{"save-success":e.req}})],1)},staticRenderFns:[]};var b=n("7jd7")(v,g,!1,function(e){n("pt1N")},"data-v-8aab60dc",null);t.default=b.exports},pt1N:function(e,t){}});
//# sourceMappingURL=3.1bba8568d33e32aaf0fd.js.map